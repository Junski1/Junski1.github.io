/*!
 * Start Bootstrap - Resume v4.0.0-beta.2 (https://startbootstrap.com/template-overviews/resume)
 * Copyright 2013-2017 Start Bootstrap
 * Licensed under MIT (https://github.com/BlackrockDigital/startbootstrap-resume/blob/master/LICENSE)
 */
const path = "../img/";
const images = [
    [
        {src: "Sludge/sludge.png", alt: "sludge"}, 
        {src:"Sludge/info.txt", alt:"info"}
    ],
    [
        {src:"DuckingOut/DuckingOut.jpg", alt: "Home screen"},
        {src:"DuckingOut/DuckingOut2.jpg", alt: "Gameplay"},
        {src:"DuckingOut/DuckingOut3.jpg", alt: "Gameplay 2"},
        {src:"DuckingOut/DuckingOut4.jpg", alt: "Gameplay 3"},
        {src:"https://www.youtube.com/embed/yu2eYUxp4lU?si=IxKgU_rRKsHkpYbj", alt: "video"},
        {src:"DuckingOut/info.txt", alt: "info"}
    ],
    [
        {src:"VisualNovel/visualNovel.png",alt:"visual novel"}, 
        {src:"VisualNovel/info.txt", alt:"info"}
    ],
   /* [
        {src:"Swiper/Swiper.jpg", alt: "Home screen"},
        {src:"Swiper/Swiper2.jpg", alt: "Gameplay"},
        {src:"Swiper/Swiper3.jpg", alt: "Gameplay 2"},
        {src:"Swiper/Swiper4.jpg", alt: "Gameplay 3"},
        {src:"https://www.youtube.com/embed/yu2eYUxp4lU?si=IxKgU_rRKsHkpYbj", alt: "video"}  
    ],*/
    [
        {src:"PhotoOrganizer/start.JPG", alt: "Home screen"},
        {src:"PhotoOrganizer/SearchPath.JPG", alt: "Path searching window"},
        {src:"PhotoOrganizer/ProcessDone.JPG", alt: "Process done"},
        {src:"PhotoOrganizer/info.txt", alt: "info"}

    ] 
];

async function CreateProjectsPage() {
    const baseClass = document.getElementById("projects").firstElementChild;
    
    var parent = baseClass;

    
    //Create the row for the gallery of clickable projects
    var newContent = document.createElement("div");
    newContent.classList.add("row");

    parent.appendChild(newContent);
    const rowClass = newContent;

    //Creates the project images in the row
    for (let i = 0; i < images.length; i++) {

        parent = rowClass;

        newContent = document.createElement("div");
        newContent.classList.add("column");

        parent.appendChild(newContent);
        parent = newContent;

        //adds clickable feature for the project images
        newContent = document.createElement("img");
        newContent.setAttribute('src', `${path}${images[i][0].src}`);
        newContent.setAttribute('onclick', `OpenModal(${i+1});CurrentSlide(${1})`);
        newContent.classList.add("hover-shadow");

        parent.appendChild(newContent);

        //creates modal slideshows for each of the projects
        parent = baseClass;
        newContent = document.createElement("div");
        newContent.classList.add("modal");
        newContent.setAttribute("id",`myModal${i+1}`);

        parent.appendChild(newContent);
        parent = newContent;

        //creates close button
        newContent = document.createElement("span");
        newContent.classList.add("close");
        newContent.classList.add("cursor");
        newContent.setAttribute("onclick", `CloseModal(${i+1})`);
        newContent.innerHTML = "&times;";
        parent.appendChild(newContent);

        newContent = document.createElement("div");
        newContent.classList.add("modal-content");

        parent.appendChild(newContent);
        parent = newContent;

        for(let j = 0; j < images[i].length; j++) {
            //creates the currently show image of the opened project
            newContent = document.createElement("div");
            newContent.classList.add("mySlides");
    
            parent.appendChild(newContent);
            parent = newContent;


            newContent = document.createElement("div");
            newContent.classList.add("numbertext");
            newContent.innerText = `${j+1} / ${images[i].length}`;

            parent.appendChild(newContent);

            if(images[i][j].alt == "video"){

                newContent = document.createElement("iframe");
                newContent.setAttribute("src", `${images[i][j].src}`);
                newContent.style.height = "600px";
                newContent.style.width = "1066px";
                parent.appendChild(newContent);

            }
            else if (images[i][j].alt == "info"){

                var info;
                await fetch(`${path}${images[i][j].src}`)
                            .then((res) => res.json()
                            .then((text) => {
                                info = text;
                            })).catch((e) => console.log(e));
                            
                newContent = document.createElement("div");
                newContent.classList.add("infotext");
                parent.appendChild(newContent);
                parent = newContent;

                newContent = document.createElement("ul");
                parent.appendChild(newContent);
                parent = newContent;
                await info.txt.split('/').forEach(element => {
                    console.log(element);
                    newContent = document.createElement("li");
                    newContent.innerHTML = element;
                    parent.appendChild(newContent);
                });
                
                parent = parent.parentElement.parentElement;
            }
            else{

                newContent = document.createElement("img");
                newContent.setAttribute('src', `${path}${images[i][j].src}`);
                newContent.style.height = "600px";
                parent.appendChild(newContent);

            }
            
            parent = parent.parentElement;
        } 

            //creates next and prev buttons to view other images
            newContent = document.createElement("a");
            newContent.classList.add("prev");
            newContent.setAttribute("onclick","PlusSlides(-1)");
            newContent.innerHTML = "&#10094;";

            parent.appendChild(newContent);


            newContent = document.createElement("a");
            newContent.classList.add("next");
            newContent.setAttribute("onclick","PlusSlides(1)");
            newContent.innerHTML = "&#10095;";

            parent.appendChild(newContent);


            newContent = document.createElement("div");
            newContent.classList.add("caption-container");
            
            parent.appendChild(newContent);
            parent = newContent;

            //name of the image
            newContent = document.createElement("p");
            newContent.setAttribute("id", "caption");

            parent.appendChild(newContent);
            
            newContent = document.createElement("div");
            newContent.classList.add("modal-row");
            
            parent.appendChild(newContent);
            parent = newContent;
            //creates little clickable images under the currently shown image
            for(let j = 0; j < images[i].length; j++) {

                parent = parent.parentElement;

                newContent = document.createElement("div");
                newContent.classList.add("column");

                parent.appendChild(newContent);
                parent = newContent;

                newContent = document.createElement("img");
                newContent.classList.add("demo");
                newContent.setAttribute("src", `${path}${images[i][j].src}`);
                newContent.setAttribute("onclick", `CurrentSlide(${j+1})`);
                newContent.setAttribute("alt", `${images[i][j].alt}`);
                parent.appendChild(newContent);
            } 
    }
}

var currentModal;
var sideBar;

function OpenModal(n) {
    sideBar = document.getElementById("sideNav");
    sideBar.style.display = "none";
    currentModal = document.getElementById(`myModal${n}`);
    currentModal.style.display = "block";
}

// Close the Modal
function CloseModal(n) {
    currentModal.style.display = "none";
    sideBar.style.display = "flex";
}

var slideIndex = 1;
ShowSlides(slideIndex);

// Next/previous controls
function PlusSlides(n) {
    ShowSlides(slideIndex += n);
}

// Thumbnail image controls
function CurrentSlide(n) {
    ShowSlides(slideIndex = n);
}

function GetElements(name){
    var elems = document.getElementsByClassName(name);
    return elems;
}

function ShowSlides(n) {
    var slides = currentModal?.querySelectorAll(".mySlides");
    var dots = currentModal?.querySelectorAll(".demo");
    var captionText = currentModal?.querySelector("#caption");
    if (n > slides.length) { slideIndex = 1 }
    if (n < 1) { slideIndex = slides.length }
    for (i = 0; i < slides.length; i++) {
        slides[i].style.display = "none";
    }
    for (i = 0; i < dots.length; i++) {
        dots[i].className = dots[i].className.replace(" active", "");
    }
    slides[slideIndex - 1].style.display = "flex";
    dots[slideIndex - 1].className += " active";
    captionText.innerHTML = dots[slideIndex - 1].alt;
}

!function(e){"use strict";e('a.js-scroll-trigger[href*="#"]:not([href="#"])').click(function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var t=e(this.hash);if((t=t.length?t:e("[name="+this.hash.slice(1)+"]")).length)return e("html, body").animate({scrollTop:t.offset().top},1e3,"easeInOutExpo"),!1}}),e(".js-scroll-trigger").click(function(){e(".navbar-collapse").collapse("hide")}),e("body").scrollspy({target:"#sideNav"})}(jQuery);
